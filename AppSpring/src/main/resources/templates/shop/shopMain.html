<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Магазин - Каталог товаров</title>

    <!-- Шрифт -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap"
          rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" th:href="@{/css/shopMain.css}">
    <link rel="stylesheet" href="/css/logout.css">
</head>

<body>

<div class="container">

    <h1>Каталог товаров</h1>

    <div class="top-nav">
        <div class="admin-link" sec:authorize="hasAuthority('ADMIN')">
            <a th:href="@{/admin}">Перейти на страницу админа</a>
        </div>

        <div th:insert="~{fragment :: header}"></div>

        <div class="cart-button">
            <form th:action="@{/shop/cart}" method="get">
                <button type="submit">Перейти в корзину</button>
            </form>
        </div>
    </div>

    <form action="/shop" class="filter-panel">

        <div class="filter-group">
            <label for="productName">Название:</label>
            <input id="productName"
                   type="text"
                   name="productName"
                   th:value="${filter.productName}"
                   placeholder="Поиск по названию">
        </div>

        <div class="filter-group">
            <label for="price">Цена (до):</label>
            <input id="price"
                   type="number"
                   name="price"
                   th:value="${filter.price}"
                   placeholder="Макс. цена">
        </div>

        <div class="filter-group">
            <label for="categoryName">Категория:</label>
            <select id="categoryName" name="categoryName">
                <option value="">Все товары</option>
                <option th:selected="${filter.categoryName == 'Видеокарты'}">Видеокарты</option>
                <option th:selected="${filter.categoryName == 'Жесткие Диски'}">Жесткие Диски</option>
                <option th:selected="${filter.categoryName == 'Мониторы'}">Мониторы</option>
                <option th:selected="${filter.categoryName == 'Наушники'}">Наушники</option>
                <option th:selected="${filter.categoryName == 'Ноутбуки'}">Ноутбуки</option>
                <option th:selected="${filter.categoryName == 'Процессоры'}">Процессоры</option>
            </select>
        </div>

        <div class="filter-group page-navigation-controls-wrapper">
            <label>&nbsp;</label> <div class="page-navigation-controls">

            <a th:if="${products.metaData.page > 0}"
               th:href="@{/shop(page=${products.metaData.page - 1}, size=${products.metaData.size}, productName=${filter.productName}, price=${filter.price}, categoryName=${filter.categoryName})}"
               class="pagination-button">
                &laquo; Предыдущая
            </a>

            <span class="page-number-display" th:text="${products.metaData.page + 1}">1</span>

            <a th:if="${products.metaData.page < products.metaData.totalPages - 1}"
               th:href="@{/shop(page=${products.metaData.page + 1}, size=${products.metaData.size}, productName=${filter.productName}, price=${filter.price}, categoryName=${filter.categoryName})}"
               class="pagination-button">
                Следующая &raquo;
            </a>
        </div>
        </div>

        <div class="filter-group page-size-select">
            <label for="size">Товаров на стр.:</label>
            <select id="size" name="size" class="styled-select">
                <option th:selected="${products.metaData.size == 10}" value="10">10</option>
                <option th:selected="${products.metaData.size == 20}" value="20">20</option>
                <option th:selected="${products.metaData.size == 30}" value="30">30</option>
            </select>
        </div>

        <div class="filter-group submit-button-wrapper">
            <label>&nbsp;</label>
            <button type="submit">Применить фильтры</button>
        </div>
    </form>

    <div class="product-grid">
        <div class="product-card" th:each="product : ${products.list}">

            <div class="product-details">
                <div class="product-name"
                     th:text="${product.productName}">
                    Название продукта
                </div>

                <div class="product-price">
                    <span th:text="${product.price}">1000</span> Рублей
                </div>
            </div>

            <div class="product-actions">
                <form th:action="@{/shop/buy}" method="post">
                    <input type="hidden" name="productName"
                           th:value="${product.productName}">
                    <button type="submit" class="buy-button">Купить</button>
                </form>

                <form th:action="@{/shop/cart/add/{name}(name=${product.productName})}"
                      method="post">
                    <button type="submit" class="add-to-cart-button">
                        В корзину
                    </button>
                </form>
            </div>

        </div>
    </div>

</div>

</body>
</html>
